# 계약 설계
- 데이터는 데이터베이스나 외부 시스템으로부터 발생
- 루틴 수행 도중 어느 시점에 다다르면 특정 클래스 호출
- 특정 클래스의 요구사항을 정의하기 위해선 사전 조건, 사후 조건 등이 필요함 
- 계약에 의한 설계

## 사전 조건과 사후 조건
- 메서드가 제대로 동작하도록 하는 사전 조건과 메서드가 산출물로 보장하는 사후 조건을 고찰할 필요가 있음
- 메서드는 사전 조건으로 음수를 받을 수 없다면?
- 사후 조건으로 음수를 리턴하면 안된다면?

### 불변식
- 메서드가 실행되기 전에 사전 조건이 유지되고, 실행 후에 사후 조건이 유지되어야 함
- 사전, 사후 모두의 경우에 유지되어야 하는 조건 = 불변식
- 제품에 대한 금액의 합계는 음수가 될 수 없음 = 불변식

### 계약 변경과 리스코프 치환 법칙
- 클래스나 메서드의 계약을 바꾸면?
  - 새로운 사전 조건이 필요함 
- 변경된 클래스를 사용하는 다른 모든 클래스를 살펴보는 것 중요
- 시스템에 기대하는 동작을 꺠뜨리지 않고 자식 클래스를 부모 클래스로 치환할 수 있는 개념을 리스코프 치환 법칙

### 계약에 의한 설계가 테스트와 어떤 관련?
- 단언문을 통해 제품 코드에서 버그를 일찍 발견 가능
  - 단언문 위반으로 얻은 에러는 매우 구체적
- 사전 조건, 사후 조건, 불변식은 개발자에게 테스트 대상을 제공
- 명시적인 계약은 소비자의 삶을 편안하게 함

### 현업에서의 계약에 의한 설계
- 계약을 모델링할 떄 매우 중요한 의사결정사항은 계약을 강하게 할지 약하게 할지 결정하게 함
- 입력 유효성 검사인가? 계약인가? 아니면 둘 다 인가?
  - 개발자들은 입력 유효성 검사가 얼마나 중요한지 알고 있음
  - 최종 사용자로부터 데이터가 들어올 떄마다 입력 유효성 검사를 실행
  - 입력 유효성: 사용자로부터 들어올 수 있는 불량 데이터나 유효하지 않은 데이터가 침투하지 않도록 함
  - 계약: 클래스 간의 의사소통이 문제없이 일어나도록 함
- 입력 유효성과 계약의 조건 검사가 중복될 수 있음
  - 입력 유효성은 중복을 지양하게 설계할 수 있음
  - 계약은 절대 위반되면 안되는 것에 해당하므로 중복 조건 검사도 가능(트레이드 오프)
